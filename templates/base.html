<!DOCTYPE html>
{% load static %}
{% load humanize %}
<html lang="fr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ settings.site_name }} - {{ settings.site_slogan }}{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block description %}{{ settings.site_description|default:settings.site_slogan }}{% endblock %}">
    <meta name="keywords" content="{% block keywords %}Jessna Techlearn, JessnaTechlearn, Jessna Tech Learn, Jessna, TechLearn, Chadrack Mbu Jess, Chadrackmbujess, Chadrack mbujess, Chadrackmbu jess, Chadrack, Chadrack mbu, mbu jess, mbu, mbu pioka, pioka, formation en ligne, cours technologie, RDC, Congo, Matadi, développement web, programmation, certifications{% endblock %}">
    <meta name="author" content="Chadrack Mbu Jess">
    <meta name="robots" content="index, follow">
    <meta name="language" content="fr-FR">
    <meta name="google-site-verification" content="Vc-oq4trU40ClGQwly9D5LtY9e9rQ3hIbuZH9Nl67TY" />
    <meta name="geo.region" content="CD-BC">
    <meta name="geo.placename" content="Matadi, Kongo Central, RDC">
    <meta name="geo.position" content="-5.8186;13.4536">
    <meta name="ICBM" content="-5.8186, 13.4536">

    <!-- PWA Manifest & Theme -->
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#000000">
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5640124347001712"
     crossorigin="anonymous"></script>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}{{ settings.site_name }} - {{ settings.site_slogan }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ settings.site_description|default:settings.site_slogan }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{% static 'images/jessnatechlearn-og.jpg' %}{% endblock %}">
    <meta property="og:site_name" content="{{ settings.site_name }}">
    <meta property="og:locale" content="fr_FR">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{% block twitter_url %}{{ request.build_absolute_uri }}{% endblock %}">
    <meta property="twitter:title" content="{% block twitter_title %}{{ settings.site_name }} - {{ settings.site_slogan }}{% endblock %}">
    <meta property="twitter:description" content="{% block twitter_description %}{{ settings.site_description|default:settings.site_slogan }}{% endblock %}">
    <meta property="twitter:image" content="{% block twitter_image %}{% static 'images/jessnatechlearn-og.jpg' %}{% endblock %}">
    <meta property="twitter:creator" content="@chadrackmbujess">

    <!-- Schema.org structured data -->
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "EducationalOrganization",
    "name": "{{ settings.site_name }}",
    "alternateName": ["Jessna Techlearn", "JessnaTechlearn", "Jessna Tech Learn", "Jessna", "TechLearn"],
    "url": "{{ request.build_absolute_uri }}",
    "logo": "{% if settings.logo %}{{ settings.logo.url }}{% else %}{% static 'images/logo.png' %}{% endif %}",
    "description": "{{ settings.site_description }}",
    "founder": {
        "@type": "Person",
        "name": "Chadrack Mbu Jess",
        "alternateName": ["Chadrackmbujess", "Chadrack mbujess", "Chadrackmbu jess", "Chadrack", "Chadrack mbu", "mbu jess", "mbu", "mbu pioka", "pioka"],
        "jobTitle": "Fondateur et CEO",
        "url": "https://chadrackmbu.pythonanywhere.com/"
    },
    "address": {
        "@type": "PostalAddress",
        "addressLocality": "Matadi",
        "addressRegion": "Kongo Central",
        "addressCountry": "CD"
    },
    "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "{{ settings.contact_phone }}",
        "contactType": "customer service",
        "email": "{{ settings.contact_email }}"
    },
    "sameAs": [
        "https://github.com/chadrackmbujess",
        "https://chadrackmbu.pythonanywhere.com/"
    ],
    "offers": {
        "@type": "Offer",
        "category": "Formation en ligne",
        "description": "Cours de technologie, développement web, programmation"
    }
}
</script>

    <!-- Canonical URL -->
    <link rel="canonical" href="{% block canonical_url %}{{ request.build_absolute_uri }}{% endblock %}">

    <!-- Favicon -->
    {% if settings.favicon %}
        <link rel="icon" type="image/x-icon" href="{{ settings.favicon.url }}">
    {% else %}
        <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    {% endif %}
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon-16x16.png' %}">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js"></script>

    <!-- Jitsi External API -->
    <script src="https://8x8.vc/vpaas-magic-cookie-81789623447a44518155995183d6395e/external_api.js" async></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-heading { font-family: 'Poppins', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-primary { background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%); }
        .glass-effect { backdrop-filter: blur(16px); background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); }
        .hover-scale { transition: all 0.3s ease; }
        .hover-scale:hover { transform: scale(1.05); }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-pulse-slow { animation: pulse 3s infinite; }
        .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .neon-glow { box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }
        .neon-glow:hover { box-shadow: 0 0 30px rgba(59, 130, 246, 0.5); }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .dark-mode {
            background: #0f172a;
            color: #f8fafc;
        }

        /* Styles pour CKEditor */
        .prose ul { list-style-type: disc !important; padding-left: 1.5rem !important; }
        .prose ol { list-style-type: decimal !important; padding-left: 1.5rem !important; }

        .info-box, .success-box, .warning-box, .error-box, .purple-box, .pink-box, .gray-box, .cyan-box {
            padding: 1rem;
            border-radius: 0.5rem;
        }
        .info-box > *:first-child, .success-box > *:first-child, .warning-box > *:first-child, .error-box > *:first-child, .purple-box > *:first-child, .pink-box > *:first-child, .gray-box > *:first-child, .cyan-box > *:first-child {
            margin-top: 0;
        }
        .info-box > *:last-child, .success-box > *:last-child, .warning-box > *:last-child, .error-box > *:last-child, .purple-box > *:last-child, .pink-box > *:last-child, .gray-box > *:last-child, .cyan-box > *:last-child {
            margin-bottom: 0;
        }

        .info-box { background-color: #EBF8FF; }
        .success-box { background-color: #F0FFF4; }
        .warning-box { background-color: #FFFBEB; }
        .error-box { background-color: #FFF5F5; }
        .purple-box { background-color: #FAF5FF; }
        .pink-box { background-color: #FFF5F7; }
        .gray-box { background-color: #F7FAFC; }
        .cyan-box { background-color: #ECFEFF; }
    </style>

    {% block extra_css %}{% endblock %}
</head>
<body class="h-full bg-gray-50 dark:bg-gray-900 transition-colors duration-300" x-data="{ darkMode: false }" :class="{ 'dark': darkMode }">

    <!-- Bouton d'installation PWA -->
    <button id="install-button" style="display: none;" class="fixed bottom-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg font-semibold flex items-center z-50">
        <i class="fas fa-download mr-2"></i>
        Installer l'application
    </button>

    <!-- Navigation -->
    <nav class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg shadow-lg fixed top-0 left-0 right-0 z-50 border-b border-gray-200 dark:border-gray-700" x-data="{ mobileMenuOpen: false }">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <!-- Logo -->
                    <div class="flex-shrink-0 flex items-center">
                        <a href="{% url 'core:home' %}" class="flex items-center text-2xl font-bold font-heading gradient-primary bg-clip-text text-transparent hover:scale-105 transition-transform">
                            {% if settings.logo %}
                                <img src="{{ settings.logo.url }}" alt="{{ settings.site_name }} Logo" class="h-8 w-auto mr-2">
                            {% else %}
                                <img src="{% static 'images/logo.png' %}" alt="Jessna Techlearn Logo" class="h-8 w-auto mr-2">
                            {% endif %}
                            <span>{{ settings.site_name }}</span>
                        </a>
                    </div>

                    <!-- Navigation principale -->
                    <div class="hidden md:ml-10 md:flex md:space-x-8">
                        <a href="{% url 'core:home' %}" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors relative group">
                            Accueil
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
                        </a>
                        <a href="{% url 'courses:list' %}" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors relative group">
                            Cours
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
                        </a>
                        <a href="{% url 'forum:index' %}" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors relative group">
                            Forum
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
                        </a>
                        <a href="{% url 'live_sessions:list' %}" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors relative group">
                            Sessions Live
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
                        </a>
                        <a href="{% url 'core:about' %}" class="text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors relative group">
                            À propos
                            <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
                        </a>
                    </div>
                </div>

                <!-- Actions utilisateur & Menu mobile -->
                <div class="flex items-center">
                    <!-- Actions pour Desktop -->
                    <div class="hidden md:flex md:items-center md:space-x-4">
                        <!-- Mode sombre -->
                        <button @click="darkMode = !darkMode" class="p-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                            <i class="fas fa-moon" x-show="!darkMode"></i>
                            <i class="fas fa-sun" x-show="darkMode"></i>
                        </button>

                        {% if user.is_authenticated %}
                            <!-- Notifications -->
                            <div class="relative" x-data="{ notifOpen: false }">
                                <button @click="notifOpen = !notifOpen" class="p-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 relative transition-colors">
                                    <i class="fas fa-bell text-lg"></i>
                                    <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse" style="display: none;"></span>
                                </button>

                                <div x-show="notifOpen" @click.away="notifOpen = false" x-transition class="absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl py-2 z-50 border border-gray-200 dark:border-gray-700">
                                    <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                                        <h3 class="font-semibold text-gray-900 dark:text-gray-100">Notifications</h3>
                                    </div>
                                    <div id="notification-dropdown-list" class="max-h-64 overflow-y-auto">
                                        <!-- Les notifications seront injectées ici par JavaScript -->
                                        <div class="px-4 py-3 text-center">
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Chargement...</p>
                                        </div>
                                    </div>
                                    <div class="px-4 py-2 border-t border-gray-200 dark:border-gray-700">
                                        <a href="{% url 'notifications:list' %}" class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 w-full text-center block">Voir toutes les notifications</a>
                                    </div>
                                </div>
                            </div>

                            <!-- Chat -->
                            <a href="{% url 'chat:liste_salons' %}" class="p-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                                <i class="fas fa-comments text-lg"></i>
                            </a>

                            <!-- Menu utilisateur -->
                            <div class="relative" x-data="{ dropdownOpen: false }">
                                <button @click="dropdownOpen = !dropdownOpen" class="flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 hover:ring-2 hover:ring-blue-300 transition-all">
                                    <img class="h-8 w-8 rounded-full object-cover border-2 border-transparent hover:border-blue-300 transition-all" src="{% if user.userprofile.avatar %}{{ user.userprofile.avatar.url }}{% else %}https://ui-avatars.com/api/?name={{ user.get_full_name|default:user.username }}&background=3B82F6&color=fff&size=32{% endif %}" alt="Avatar">
                                    <span class="ml-2 text-gray-700 dark:text-gray-300 font-medium">{{ user.get_full_name|default:user.username }}</span>
                                    <i class="fas fa-chevron-down ml-1 text-xs text-gray-500 dark:text-gray-400"></i>
                                </button>

                                <div x-show="dropdownOpen" @click.away="dropdownOpen = false" x-transition class="absolute right-0 mt-2 w-56 bg-white dark:bg-gray-800 rounded-lg shadow-xl py-2 z-50 border border-gray-200 dark:border-gray-700">
                                    <div class="px-4 py-2 border-b border-gray-200 dark:border-gray-700">
                                        <p class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ user.get_full_name|default:user.username }}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">{{ user.email }}</p>
                                    </div>

                                    <a href="{% url 'core:dashboard' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-tachometer-alt mr-3 text-blue-500"></i>Tableau de bord
                                    </a>
                                    <a href="{% url 'accounts:profile' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-user mr-3 text-green-500"></i>Mon Profil
                                    </a>
                                    <a href="{% url 'courses:my_courses' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-book mr-3 text-purple-500"></i>Mes Cours
                                    </a>
                                    <a href="{% url 'certificates:my_certificates' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-certificate mr-3 text-yellow-500"></i>Mes Certificats
                                    </a>
                                    <a href="{% url 'payments:history' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-credit-card mr-3 text-orange-500"></i>Paiements
                                    </a>

                                    <hr class="my-2 border-gray-200 dark:border-gray-700">

                                    <a href="{% url 'accounts:edit_profile' %}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-cog mr-3 text-gray-500"></i>Paramètres
                                    </a>
                                    <a href="{% url 'accounts:logout' %}" class="flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors">
                                        <i class="fas fa-sign-out-alt mr-3"></i>Déconnexion
                                    </a>
                                </div>
                            </div>
                        {% else %}
                            <a href="{% url 'accounts:login' %}" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors">
                                Connexion
                            </a>
                            <a href="{% url 'accounts:register' %}" class="gradient-primary text-white px-6 py-2 rounded-lg text-sm font-medium hover:shadow-lg neon-glow transition-all hover-scale">
                                Inscription Gratuite
                            </a>
                        {% endif %}
                    </div>

                    <!-- Actions pour Mobile -->
                    <div class="md:hidden flex items-center">
                        {% if user.is_authenticated %}
                            <!-- Notifications -->
                            <a href="{% url 'notifications:list' %}" class="p-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 relative transition-colors">
                                <i class="fas fa-bell text-lg"></i>
                                <span id="notification-badge-mobile" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse" style="display: none;"></span>
                            </a>
                        {% endif %}
                        <!-- Bouton Hamburger -->
                        <button @click="mobileMenuOpen = !mobileMenuOpen" class="ml-2 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                            <i class="fas fa-bars text-lg" x-show="!mobileMenuOpen"></i>
                            <i class="fas fa-times text-lg" x-show="mobileMenuOpen"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Menu mobile -->
        <div x-show="mobileMenuOpen" x-transition class="md:hidden bg-white/95 dark:bg-gray-900/95 backdrop-blur-lg border-t border-gray-200 dark:border-gray-700" @click.away="mobileMenuOpen = false">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="{% url 'core:home' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
                <a href="{% url 'courses:list' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-book mr-2"></i>Cours
                </a>
                <a href="{% url 'forum:index' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-comments mr-2"></i>Forum
                </a>
                <a href="{% url 'live_sessions:list' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-video mr-2"></i>Sessions Live
                </a>
                <a href="{% url 'chat:liste_salons' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-comments mr-2"></i>Chat
                </a>
                <a href="{% url 'core:about' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                    <i class="fas fa-info-circle mr-2"></i>À propos
                </a>

                {% if user.is_authenticated %}
                    <hr class="my-2 border-gray-200 dark:border-gray-700">
                    <a href="{% url 'core:dashboard' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-tachometer-alt mr-2"></i>Tableau de bord
                    </a>
                    <a href="{% url 'accounts:profile' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-user mr-2"></i>Mon Profil
                    </a>
                    <a href="{% url 'certificates:my_certificates' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-certificate mr-3"></i>Mes Certificats
                    </a>
                    <a href="{% url 'payments:history' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-credit-card mr-3"></i>Paiements
                    </a>
                    <a href="{% url 'accounts:edit_profile' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-cog mr-3"></i>Paramètres
                    </a>
                    <a href="{% url 'accounts:logout' %}" class="block px-3 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>Déconnexion
                    </a>
                {% else %}
                    <hr class="my-2 border-gray-200 dark:border-gray-700">
                    <a href="{% url 'accounts:login' %}" class="block px-3 py-2 text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors">
                        <i class="fas fa-sign-in-alt mr-2"></i>Connexion
                    </a>
                    <a href="{% url 'accounts:register' %}" class="block px-3 py-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition-colors font-medium">
                        <i class="fas fa-user-plus mr-2"></i>Inscription Gratuite
                    </a>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- Messages Flash -->
    {% if messages %}
        <div class="fixed top-20 right-4 z-50 space-y-2">
            {% for message in messages %}
                <div x-data="{ show: true }"
                     x-init="setTimeout(() => show = false, 5000)"
                     x-show="show"
                     x-transition:leave="transition ease-in duration-300"
                     x-transition:leave-start="opacity-100 transform scale-100"
                     x-transition:leave-end="opacity-0 transform scale-90"
                     class="{% if message.tags == 'error' %}bg-red-500{% elif message.tags == 'warning' %}bg-yellow-500{% elif message.tags == 'info' %}bg-blue-500{% else %}bg-green-500{% endif %} text-white px-6 py-4 rounded-lg shadow-xl flex items-center justify-between max-w-sm backdrop-blur-lg">
                    <div class="flex items-center">
                        <i class="{% if message.tags == 'error' %}fas fa-exclamation-triangle{% elif message.tags == 'warning' %}fas fa-exclamation-circle{% elif message.tags == 'info' %}fas fa-info-circle{% else %}fas fa-check-circle{% endif %} mr-3"></i>
                        <span class="font-medium">{{ message }}</span>
                    </div>
                    <button @click="show = false" class="ml-4 text-white hover:text-gray-200 transition-colors">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Contenu principal -->
    <main class="flex-1 min-h-screen pt-16">
        {% block content %}{% endblock %}
    </main>

    <!-- AdSense Banniere Principale (avant le footer) -->
    <div class="container mx-auto my-8 px-4">
        <!-- Bannière principale -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-5640124347001712"
             data-ad-slot="6950316415"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 dark:bg-gray-950 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center mb-6">
                        {% if settings.logo %}
                            <img src="{{ settings.logo.url }}" alt="{{ settings.site_name }} Logo" class="h-10 w-auto mr-3">
                        {% else %}
                            <img src="{% static 'images/logo.png' %}" alt="Jessna Techlearn Logo" class="h-10 w-auto mr-3">
                        {% endif %}
                        <span class="text-3xl font-bold font-heading">{{ settings.site_name }}</span>
                    </div>
                    <p class="text-gray-400 mb-6 text-lg leading-relaxed">
                        <strong class="text-blue-400">"{{ settings.site_slogan }}"</strong><br>
                        {{ settings.site_description }}
                    </p>
                    <div class="flex space-x-6">
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors transform hover:scale-110">
                            <i class="fab fa-facebook text-2xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors transform hover:scale-110">
                            <i class="fab fa-twitter text-2xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors transform hover:scale-110">
                            <i class="fab fa-linkedin text-2xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors transform hover:scale-110">
                            <i class="fab fa-youtube text-2xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-blue-400 transition-colors transform hover:scale-110">
                            <i class="fab fa-github text-2xl"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-semibold font-heading mb-6 text-blue-400">Formation</h3>
                    <ul class="space-y-3">
                        <li><a href="{% url 'courses:list' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Tous les cours
                        </a></li>
                        <li><a href="{% url 'certificates:my_certificates' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Certifications
                        </a></li>
                        <li><a href="{% url 'live_sessions:list' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Sessions live
                        </a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Parcours
                        </a></li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-xl font-semibold font-heading mb-6 text-blue-400">Support</h3>
                    <ul class="space-y-3">
                        <li><a href="{% url 'core:faq' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Centre d'aide
                        </a></li>
                        <li><a href="{% url 'forum:index' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Forum communauté
                        </a></li>
                        <li><a href="{% url 'core:about' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>Contact
                        </a></li>
                        <li><a href="{% url 'core:faq' %}" class="text-gray-400 hover:text-white transition-colors flex items-center group">
                            <i class="fas fa-chevron-right mr-2 text-xs group-hover:translate-x-1 transition-transform"></i>FAQ
                        </a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-12 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-center md:text-left mb-4 md:mb-0">
                        <p class="text-gray-400">
                            &copy; 2025 <span class="text-blue-400 font-semibold">{{ settings.site_name }}</span>. Tous droits réservés.
                        </p>
                        <p class="text-sm text-gray-500 mt-1">
                            Créé avec ❤️ par <span class="text-blue-400">Chadrack Mbu Jess</span>
                        </p>
                    </div>
                    <div class="flex items-center space-x-6 text-sm">
                        <a href="{% url 'core:privacy_policy' %}" class="text-gray-400 hover:text-white transition-colors">Politique de confidentialité</a>
                        <a href="{% url 'core:terms_of_service' %}" class="text-gray-400 hover:text-white transition-colors">Conditions d'utilisation</a>
                        <a href="{% url 'core:legal_notice' %}" class="text-gray-400 hover:text-white transition-colors">Mentions légales</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- Gestion du mode sombre ---
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }

        document.addEventListener('alpine:init', () => {
            Alpine.data('darkMode', () => ({
                darkMode: localStorage.getItem('darkMode') === 'true',
                toggle() {
                    this.darkMode = !this.darkMode;
                    localStorage.setItem('darkMode', this.darkMode);
                    document.documentElement.classList.toggle('dark', this.darkMode);
                }
            }));
        });

        // --- Gestion de l'installation PWA ---
        let deferredPrompt;
        const installButton = document.getElementById('install-button');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if (installButton) {
                installButton.style.display = 'flex';
            }
        });

        if (installButton) {
            installButton.addEventListener('click', () => {
                if (!deferredPrompt) {
                    return;
                }
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    console.log(`User response to the install prompt: ${choiceResult.outcome}`);
                    deferredPrompt = null;
                    installButton.style.display = 'none';
                });
            });
        }

        // --- Enregistrement du Service Worker ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register("{% static 'serviceworker.js' %}")
                    .then(registration => {
                        console.log('Service Worker enregistré avec succès:', registration);
                    })
                    .catch(error => {
                        console.log('Échec de l'enregistrement du Service Worker:', error);
                    });
            });
        }
    </script>

    {% block extra_js %}
    {% if user.is_authenticated %}
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const notificationBadge = document.getElementById('notification-badge');
        const notificationBadgeMobile = document.getElementById('notification-badge-mobile');
        const dropdownList = document.getElementById('notification-dropdown-list');
        const csrftoken = '{{ csrf_token }}';

        function fetchNotifications() {
            fetch("{% url 'notifications:latest_notifications' %}")
                .then(response => response.json())
                .then(data => {
                    // Mettre à jour le compteur
                    if (data.unread_count > 0) {
                        notificationBadge.textContent = data.unread_count;
                        notificationBadge.style.display = 'flex';
                        notificationBadgeMobile.textContent = data.unread_count;
                        notificationBadgeMobile.style.display = 'flex';
                    } else {
                        notificationBadge.style.display = 'none';
                        notificationBadgeMobile.style.display = 'none';
                    }

                    // Mettre à jour la liste déroulante
                    dropdownList.innerHTML = ''; // Vider la liste actuelle
                    if (data.notifications.length > 0) {
                        data.notifications.forEach(notif => {
                            const notifLink = document.createElement('a');
                            notifLink.href = notif.action_url || '#';
                            notifLink.className = 'notification-link block px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors';
                            notifLink.dataset.notificationId = notif.id;

                            let notifClass = notif.is_read ? '' : ' font-bold';

                            notifLink.innerHTML = `
                                <div class="flex items-start">
                                    <div class="flex-shrink-0">
                                        <i class="${notif.icon_class}"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-900 dark:text-gray-100${notifClass}">${notif.title}</p>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">${notif.created_at}</p>
                                    </div>
                                </div>
                            `;
                            dropdownList.appendChild(notifLink);
                        });
                    } else {
                        dropdownList.innerHTML = `
                            <div class="px-4 py-3 text-center">
                                <p class="text-sm text-gray-500 dark:text-gray-400">Vous n'avez aucune nouvelle notification.</p>
                            </div>
                        `;
                    }
                })
                .catch(error => {
                    console.error('Erreur lors de la récupération des notifications:', error);
                    dropdownList.innerHTML = `
                        <div class="px-4 py-3 text-center">
                            <p class="text-sm text-red-500">Erreur de chargement.</p>
                        </div>
                    `;
                });
        }

        // Gérer le clic sur une notification
        dropdownList.addEventListener('click', function(event) {
            const link = event.target.closest('.notification-link');
            if (link) {
                event.preventDefault();
                const notificationId = link.dataset.notificationId;
                const destinationUrl = link.href;

                fetch(`/notifications/marquer-lu/${notificationId}/`, {
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': csrftoken,
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Décrémenter le compteur de notifications
                        const currentCount = parseInt(notificationBadge.textContent);
                        if (!isNaN(currentCount) && currentCount > 0) {
                            const newCount = currentCount - 1;
                            if (newCount > 0) {
                                notificationBadge.textContent = newCount;
                                notificationBadgeMobile.textContent = newCount;
                            } else {
                                notificationBadge.style.display = 'none';
                                notificationBadgeMobile.style.display = 'none';
                            }
                        }
                    }
                })
                .finally(() => {
                    window.location.href = destinationUrl;
                });
            }
        });

        // Récupérer les notifications au chargement de la page, puis toutes les 30 secondes
        fetchNotifications();
        setInterval(fetchNotifications, 30000);
    });
    </script>
    {% endif %}
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- Global Alert System (Desktop Notification Only) ---
        const alertAudio = new Audio("{% static 'sounds/global_alert.mp3' %}");

        // 1. Ask for Notification Permissions on load if not already set
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // 2. Function to show a persistent desktop notification with sound
        function showDesktopNotification() {
            const notification = new Notification('{{ settings.site_name }} - Alerte', {
                body: 'Une annonce importante a été publiée. Cliquez ici pour voir.',
                icon: '{% if settings.logo %}{{ settings.logo.url }}{% else %}{% static "images/logo.png" %}{% endif %}',
                tag: 'global-alert',
                requireInteraction: true // Makes the notification persistent
            });

            // Play our custom sound
            alertAudio.play().catch(e => console.warn("Audio play failed:", e));

            // Stop sound and focus window on click
            notification.onclick = function() {
                window.focus();
                alertAudio.pause();
                alertAudio.currentTime = 0;
                this.close();
            };

            // Also stop sound if the user closes the notification manually
            notification.onclose = function() {
                alertAudio.pause();
                alertAudio.currentTime = 0;
            };
        }

        // 3. Main checking logic
        function checkGlobalAlert() {
            if (window.location.pathname.startsWith('/admin/')) return;

            fetch("{% url 'notifications:check_global_alert' %}")
                .then(response => response.json())
                .then(data => {
                    if (data.alert_active) {
                        const COOLDOWN_PERIOD = 6 * 60 * 60 * 1000; // 6 hours
                        const lastShownTimestamp = localStorage.getItem('globalAlertLastShown');
                        const now = new Date().getTime();

                        if (!lastShownTimestamp || (now - parseInt(lastShownTimestamp)) > COOLDOWN_PERIOD) {
                            if (Notification.permission === 'granted' && document.hidden) {
                                showDesktopNotification();
                                localStorage.setItem('globalAlertLastShown', now.toString());
                            }
                        }
                    }
                })
                .catch(error => console.error('Error checking for global alert:', error));
        }

        setInterval(checkGlobalAlert, 15000); // Check every 15s
    });
    </script>
    {% endblock %}
</body>
</html>